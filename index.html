<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LearnWG Language Tutorâ„¢ - AI-powered language learning with GPT-4 and natural voices. Learn English, Spanish, French, German, Portuguese with personalized AI tutoring.">
    <meta name="keywords" content="language learning, AI tutor, GPT-4, LearnWG, language practice, multilingual, voice recognition">
    <title>LearnWG Language Tutorâ„¢ - AI-Powered Learning</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.svg">
    <link rel="apple-touch-icon" href="favicon.svg">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="LearnWG Language Tutorâ„¢">
    <meta property="og:description" content="Master languages with AI-powered conversation practice. Natural voices, real-time feedback, 5 languages.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="favicon.svg">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Animated Background -->
    <div class="background-animation">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <svg class="logo-icon" width="32" height="32" viewBox="0 0 120 120">
                        <defs>
                            <linearGradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#667eea"/>
                                <stop offset="100%" style="stop-color:#f093fb"/>
                            </linearGradient>
                        </defs>
                        <circle cx="60" cy="60" r="56" fill="url(#logoGrad)"/>
                        <text x="60" y="75" font-family="Space Grotesk, sans-serif" font-size="48" font-weight="900" fill="white" text-anchor="middle">LW</text>
                    </svg>
                    <span>LearnWG Language Tutorâ„¢</span>
                </div>
                <button class="sidebar-toggle" id="sidebar-toggle">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- Language Selector -->
            <div class="language-selector">
                <h3>Active Language</h3>
                <div class="language-grid">
                    <button class="language-btn" data-lang="en-US" data-name="English">
                        <span class="flag">ðŸ‡¬ðŸ‡§</span>
                        <span class="lang-name">English</span>
                    </button>
                    <button class="language-btn" data-lang="es-ES" data-name="Spanish">
                        <span class="flag">ðŸ‡ªðŸ‡¸</span>
                        <span class="lang-name">Spanish</span>
                    </button>
                    <button class="language-btn" data-lang="fr-FR" data-name="French">
                        <span class="flag">ðŸ‡«ðŸ‡·</span>
                        <span class="lang-name">French</span>
                    </button>
                    <button class="language-btn" data-lang="de-DE" data-name="German">
                        <span class="flag">ðŸ‡©ðŸ‡ª</span>
                        <span class="lang-name">German</span>
                    </button>
                    <button class="language-btn" data-lang="pt-PT" data-name="Portuguese">
                        <span class="flag">ðŸ‡µðŸ‡¹</span>
                        <span class="lang-name">Portuguese</span>
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h3>Learning Modes</h3>
                <button class="action-btn" onclick="setMode('conversation')">
                    <i class="fas fa-comments"></i>
                    <span>Free Conversation</span>
                </button>
                <button class="action-btn" onclick="setMode('grammar')">
                    <i class="fas fa-book"></i>
                    <span>Grammar Help</span>
                </button>
                <button class="action-btn" onclick="setMode('vocabulary')">
                    <i class="fas fa-spell-check"></i>
                    <span>Vocabulary Builder</span>
                </button>
                <button class="action-btn" onclick="setMode('practice')">
                    <i class="fas fa-dumbbell"></i>
                    <span>Practice Exercises</span>
                </button>
                <button class="action-btn" onclick="setMode('assessment')">
                    <i class="fas fa-chart-line"></i>
                    <span>Level Assessment</span>
                </button>
            </div>

            <!-- Teaching Mode -->
            <div class="quick-actions" style="margin-top: var(--spacing-md);">
                <h3>For Educators</h3>
                <button class="action-btn teaching-mode-btn" onclick="setMode('teaching')">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <span>Teaching Studio</span>
                    <span class="mode-badge">NEW</span>
                </button>
            </div>

            <!-- Session Controls -->
            <div class="session-controls">
                <button class="control-btn" onclick="clearChat()">
                    <i class="fas fa-trash-alt"></i>
                    <span>Clear Chat</span>
                </button>
                <button class="control-btn" onclick="openTutorial()">
                    <i class="fas fa-info-circle"></i>
                    <span>Help & Tips</span>
                </button>
            </div>

            <!-- Donate Button -->
            <div class="donate-section">
                <a href="https://buymeacoffee.com/georgegeorge" target="_blank" rel="noopener noreferrer" class="donate-btn">
                    <div class="coffee-steam">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <i class="fas fa-coffee"></i>
                    <span class="donate-text">Buy Me a Coffee</span>
                    <div class="donate-sparkle">âœ¨</div>
                </a>
                <p class="donate-tagline">Support LearnWG Language Tutorâ„¢ development</p>
            </div>
        </aside>

        <!-- Chat Section -->
        <main class="chat-section">
            <!-- Header -->
            <header class="chat-header">
                <button class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="header-info">
                    <h1>
                        <svg class="header-logo-icon" width="24" height="24" viewBox="0 0 120 120">
                            <circle cx="60" cy="60" r="56" fill="url(#logoGrad)"/>
                            <text x="60" y="75" font-family="Space Grotesk" font-size="48" font-weight="900" fill="white" text-anchor="middle">LW</text>
                        </svg>
                        LearnWG Language Tutorâ„¢
                    </h1>
                    <p id="current-language">Select a language to begin</p>
                </div>
                <div class="header-actions">
                    <button class="header-btn" onclick="toggleSettings()" title="Settings">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
        </header>
        
            <!-- Welcome Screen -->
            <div class="welcome-screen" id="welcome-screen">
                <div class="welcome-content">
                    <div class="welcome-icon">
                        <svg width="80" height="80" viewBox="0 0 120 120">
                            <defs>
                                <linearGradient id="welcomeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#667eea"/>
                                    <stop offset="100%" style="stop-color:#f093fb"/>
                                </linearGradient>
                            </defs>
                            <circle cx="60" cy="60" r="56" fill="url(#welcomeGrad)"/>
                            <text x="60" y="80" font-family="Space Grotesk" font-size="56" font-weight="900" fill="white" text-anchor="middle">LW</text>
                        </svg>
                    </div>
                    <h2>Welcome to LearnWG Language Tutorâ„¢</h2>
                    <p>Your AI-powered companion for mastering new languages</p>
                    <div class="welcome-features">
                        <div class="feature-card">
                            <i class="fas fa-brain"></i>
                            <h3>Smart Learning</h3>
                            <p>Adaptive AI that adjusts to your level</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-microphone"></i>
                            <h3>Voice Practice</h3>
                            <p>Speak and listen to improve pronunciation</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-tasks"></i>
                            <h3>Multiple Modes</h3>
                            <p>Grammar, vocabulary, conversation & more</p>
                        </div>
                    </div>
                    <button class="cta-button" onclick="hideWelcome()">
                        Get Started
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Conversation Starters (shown after language selection) -->
            <div class="conversation-starters" id="conversation-starters" style="display: none;">
                <h3>Get Started</h3>
                <div class="starter-grid" id="starter-grid">
                    <!-- Dynamically populated -->
                </div>
            </div>

            <!-- Chat Area -->
            <div class="chat-area" id="chat-area">
                <div class="chat-log" id="chat-log">
                    <!-- Messages appear here -->
                </div>

                <!-- Typing Indicator -->
                <div class="typing-indicator" id="typing-indicator" style="display: none;">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <span>Tutor is typing...</span>
                </div>
            </div>

            <!-- Input Area -->
            <div class="input-container">
                <!-- Current Mode Indicator -->
                <div class="mode-indicator" id="mode-indicator">
                    <i class="fas fa-comments"></i>
                    <span>Conversation Mode</span>
                </div>

                <!-- Voice Recording Panel (shown when recording) -->
                <div class="voice-recording-panel" id="voice-recording-panel" style="display: none;">
                    <div class="recording-header">
                        <div class="recording-status">
                            <div class="recording-pulse"></div>
                            <span>Listening...</span>
                        </div>
                        <span class="recording-timer" id="recording-timer">0:00</span>
                    </div>
                    
                    <div class="voice-visualizer">
                        <canvas id="voice-canvas" width="600" height="100"></canvas>
                    </div>
                    
                    <div class="voice-level-container">
                        <i class="fas fa-volume-down"></i>
                        <div class="voice-level-bar">
                            <div class="voice-level-fill" id="voice-level-fill"></div>
                        </div>
                        <i class="fas fa-volume-up"></i>
                    </div>

                    <div class="recording-actions">
                        <button class="recording-btn cancel-btn" onclick="cancelVoiceRecording()">
                            <i class="fas fa-times"></i>
                            Cancel
                        </button>
                        <button class="recording-btn stop-btn" onclick="stopVoiceRecording()">
                            <i class="fas fa-stop"></i>
                            Stop & Send
                        </button>
                    </div>

                    <p class="recording-hint">Speak clearly in <span id="recording-language">the selected language</span></p>
        </div>
        
                <div class="input-wrapper">
                    <div class="voice-controls">
                        <button class="input-action-btn" id="mic-button" onclick="toggleVoiceRecognition()" title="Voice Input (Ctrl+Space)">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button class="input-action-btn" id="continuous-mode-btn" onclick="toggleContinuousMode()" title="Continuous Listening Mode">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="input-action-btn" id="voice-settings-btn" onclick="openVoiceSettings()" title="Voice Settings">
                            <i class="fas fa-sliders-h"></i>
                        </button>
                    </div>
                    <input 
                        type="text" 
                        id="user-input" 
                        placeholder="Type your message or use voice input..." 
                        autocomplete="off"
                    />
                    <button class="send-btn" onclick="sendMessage()" title="Send Message (Enter)">
                        <i class="fas fa-paper-plane"></i>
                    </button>
        </div>

                <div class="input-footer">
                    <div class="footer-left">
                        <span class="shortcut-hint">
                            <kbd>Enter</kbd> to send â€¢ <kbd>Ctrl+Space</kbd> for voice
                        </span>
                    </div>
                    <div class="footer-right">
                        <label class="auto-play-toggle">
                            <input type="checkbox" id="auto-play-toggle" checked onchange="toggleAutoPlay()">
                            <span>Auto-play responses</span>
                        </label>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Tutorial Modal -->
    <div id="tutorial-modal" class="modal">
        <div class="modal-content modal-large">
            <button class="modal-close" onclick="closeTutorial()">
                <i class="fas fa-times"></i>
            </button>

            <div class="modal-header">
                <i class="fas fa-graduation-cap"></i>
                    <h2>Welcome to LearnWG Language Tutorâ„¢!</h2>
            </div>

            <div class="modal-body">
                <div class="tutorial-section">
                    <h3><i class="fas fa-rocket"></i> Getting Started</h3>
                    <ol>
                        <li>Select a language from the sidebar (English, Spanish, French, German, or Portuguese)</li>
                        <li>Choose a learning mode or start with free conversation</li>
                        <li>Type your question or use the microphone for voice input</li>
                        <li>Get instant feedback and explanations from your AI tutor</li>
                    </ol>
                </div>

                <div class="tutorial-section">
                    <h3><i class="fas fa-lightbulb"></i> Learning Modes</h3>
                <ul class="feature-list">
                    <li>
                        <i class="fas fa-comments"></i>
                        <div>
                            <strong>Free Conversation</strong>
                            <p>Practice natural conversations in your target language</p>
                        </div>
                    </li>
                    <li>
                        <i class="fas fa-book"></i>
                        <div>
                            <strong>Grammar Help</strong>
                            <p>Get detailed explanations about grammar rules and usage</p>
                        </div>
                    </li>
                    <li>
                        <i class="fas fa-spell-check"></i>
                        <div>
                            <strong>Vocabulary Builder</strong>
                            <p>Learn new words and phrases with examples</p>
                        </div>
                    </li>
                    <li>
                        <i class="fas fa-dumbbell"></i>
                        <div>
                            <strong>Practice Exercises</strong>
                            <p>Test your knowledge with interactive exercises</p>
                        </div>
                    </li>
                    <li>
                        <i class="fas fa-chart-line"></i>
                        <div>
                            <strong>Level Assessment</strong>
                            <p>Evaluate your current proficiency level</p>
                        </div>
                    </li>
                    <li>
                        <i class="fas fa-chalkboard-teacher"></i>
                        <div>
                            <strong>Teaching Studio (NEW!)</strong>
                            <p>For educators: Create lessons, generate exercises, get teaching tips</p>
                        </div>
                    </li>
                </ul>
                </div>

                <div class="tutorial-section">
                    <h3><i class="fas fa-keyboard"></i> Tips & Tricks</h3>
                    <ul>
                        <li>Use the microphone button to practice speaking and pronunciation</li>
                        <li>The AI remembers your conversation context for better responses</li>
                        <li>Click "Clear Chat" to start a fresh conversation</li>
                        <li>Switch languages anytime to practice multiple languages</li>
                        <li>Copy any message by clicking the copy icon</li>
                    </ul>
                </div>
            </div>

            <div class="modal-footer">
                <button class="cta-button" onclick="closeTutorial()">
                    Start Learning
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="toggleSettings()">
                <i class="fas fa-times"></i>
            </button>

            <div class="modal-header">
                <i class="fas fa-cog"></i>
                <h2>Settings</h2>
            </div>

            <div class="modal-body">
                <div class="setting-item">
                    <label>
                        <i class="fas fa-volume-up"></i>
                        Text-to-Speech
                    </label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="tts-toggle" checked onchange="toggleTTS()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="setting-item">
                    <label>
                        <i class="fas fa-clock"></i>
                        Show Timestamps
                    </label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="timestamp-toggle" checked onchange="toggleTimestamps()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="setting-item">
                    <label>
                        <i class="fas fa-moon"></i>
                        Dark Mode
                    </label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="theme-toggle" checked onchange="toggleTheme()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Voice Settings Modal -->
    <div id="voice-settings-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeVoiceSettings()">
                <i class="fas fa-times"></i>
            </button>

            <div class="modal-header">
                <i class="fas fa-microphone-alt"></i>
                <h2>Voice Settings</h2>
            </div>

            <div class="modal-body">
                <!-- Voice Selection -->
                <div class="voice-setting-group">
                    <h3><i class="fas fa-user-circle"></i> OpenAI Voice Selection</h3>
                    <div class="setting-item-vertical">
                        <label for="voice-select">Choose AI Voice</label>
                        <p class="setting-description">
                            Natural, human-like voices powered by OpenAI's advanced TTS technology
                        </p>
                        <select id="voice-select" onchange="updateSelectedVoice()">
                            <option value="auto">Auto (Best for Language)</option>
                        </select>
                        <button class="test-voice-btn" onclick="testVoice()">
                            <i class="fas fa-play"></i> Test Voice
                        </button>
                    </div>
                </div>

                <!-- Speech Rate -->
                <div class="voice-setting-group">
                    <h3><i class="fas fa-tachometer-alt"></i> Speech Rate</h3>
                    <div class="setting-item-vertical">
                        <div class="slider-header">
                            <label>Speed</label>
                            <span id="rate-value">0.95x</span>
                        </div>
                        <input type="range" id="speech-rate" min="0.5" max="2" step="0.05" value="0.95" oninput="updateSpeechRate(this.value)">
                        <div class="slider-labels">
                            <span>Slower (0.5x)</span>
                            <span>Learning Speed (0.95x)</span>
                            <span>Faster (2x)</span>
                        </div>
                        <p class="setting-hint">
                            <i class="fas fa-lightbulb"></i> 
                            Slightly slower speed (0.95x) is optimal for language learning and pronunciation practice
                        </p>
                    </div>
                </div>

                <!-- Volume -->
                <div class="voice-setting-group">
                    <h3><i class="fas fa-volume-up"></i> Volume</h3>
                    <div class="setting-item-vertical">
                        <div class="slider-header">
                            <label>Volume</label>
                            <span id="volume-value">100%</span>
                        </div>
                        <input type="range" id="speech-volume" min="0" max="1" step="0.1" value="1" oninput="updateSpeechVolume(this.value)">
                        <div class="slider-labels">
                            <span>Quiet</span>
                            <span>Medium</span>
                            <span>Loud</span>
                        </div>
                    </div>
                </div>

                <!-- Voice Features -->
                <div class="voice-setting-group">
                    <h3><i class="fas fa-magic"></i> Voice Features</h3>
                    
                    <div class="setting-item">
                        <label>
                            <i class="fas fa-infinity"></i>
                            Continuous Listening
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="continuous-listening-toggle" onchange="updateContinuousListening()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="setting-item">
                        <label>
                            <i class="fas fa-play-circle"></i>
                            Auto-play Responses
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="auto-play-setting-toggle" checked onchange="updateAutoPlaySetting()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="setting-item">
                        <label>
                            <i class="fas fa-bell"></i>
                            Voice Notifications
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="voice-notifications-toggle" checked onchange="updateVoiceNotifications()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Recognition Settings -->
                <div class="voice-setting-group">
                    <h3><i class="fas fa-microphone"></i> Voice Technology</h3>
                    
                    <div class="setting-item-vertical">
                        <label>Current Setup</label>
                        <p class="setting-description">
                            <strong>Recognition Language:</strong> <span id="current-recognition-lang">Not selected</span><br>
                            <strong>TTS Engine:</strong> OpenAI TTS-1-HD (Premium Quality)<br>
                            <strong>Audio Format:</strong> MP3 with intelligent caching
                        </p>
                        <p class="setting-hint">
                            <i class="fas fa-info-circle"></i> 
                            Using OpenAI's state-of-the-art text-to-speech for natural, human-like pronunciation. 
                            Recognition language updates automatically with your learning language selection.
                        </p>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="secondary-btn" onclick="resetVoiceSettings()">
                    <i class="fas fa-undo"></i>
                    Reset to Defaults
                </button>
                <button class="cta-button" onclick="closeVoiceSettings()">
                    Done
                </button>
            </div>
        </div>
    </div>

    <footer class="app-footer">
        <p>&copy; <span id="year"></span> <a href="https://learnwg.vercel.app/" target="_blank">LearnWG</a> Language Tutorâ„¢ - Powered by GPT-4 & OpenAI TTS</p>
    </footer>

    <script src="script.js"></script>
    <script>
        // Set current year
        document.getElementById('year').textContent = new Date().getFullYear();
    </script>
<!-- Zentix Chatbot: Language Tutor -->
<script>
!function(){var c={"id":"seSqxNoYOysaG4R1HK3I","name":"Language Tutor","language":"en","welcomeMessage":"Hello! How can I help you today?","primaryColor":"#667eea","position":"bottom-right","apiKey":"zentix_woasmrp6gncpmf96kvmh7b","apiUrl":"https://zentix-1-0.vercel.app/api/chatbot-api"};var p={"w":"bottom:30px;right:30px;","c":"bottom:100px;right:30px;"};var d=document;var s=d.createElement('style');s.textContent='.zt-w{position:fixed;'+p.w+';width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 5px 15px rgba(0,0,0,0.2);z-index:9999;color:#fff;font-size:12px;transition:all 0.3s}.zt-w:hover{transform:scale(1.1)}.zt-c{position:fixed;'+p.c+';width:350px;max-width:90%;background:#fff;border-radius:10px;box-shadow:0 5px 30px rgba(0,0,0,0.2);z-index:10000;display:none;overflow:hidden}.zt-h{padding:15px 20px;color:#fff;display:flex;justify-content:space-between;align-items:center}.zt-t{display:flex;align-items:center;gap:10px;font-weight:500}.zt-x{cursor:pointer;font-size:18px;transition:all 0.3s}.zt-x:hover{transform:rotate(90deg)}.zt-m{height:300px;overflow-y:auto;padding:20px;background:#f5f7ff}.zt-msg{margin-bottom:15px;display:flex}.zt-msg.u{justify-content:flex-end}.zt-msg.b{justify-content:flex-start}.zt-msg-c{max-width:80%;padding:10px 15px;border-radius:18px;font-size:14px;line-height:1.4}.zt-msg.u .zt-msg-c{color:#fff;border-bottom-right-radius:5px}.zt-msg.b .zt-msg-c{background:#fff;color:#333;border-bottom-left-radius:5px;box-shadow:0 2px 5px rgba(0,0,0,0.05)}.zt-i{display:flex;padding:15px;border-top:1px solid #f1f1f1;background:#fff}.zt-i input{flex:1;padding:10px 15px;border:1px solid #f1f1f1;border-radius:30px;outline:none;font-size:14px}.zt-i button{width:40px;height:40px;border-radius:50%;border:none;margin-left:10px;cursor:pointer;color:#fff}@media(max-width:768px){.zt-c{width:90%;'+p.c.replace('30px','5%')+'}.zt-w{width:50px;height:50px;'+p.w.replace('30px','20px')+'}}';d.head.appendChild(s);var w=d.createElement('div');w.id='zt-widget';w.innerHTML='<div class="zt-w" style="background:'+c.primaryColor+'"><i class="fas fa-robot"></i></div><div class="zt-c"><div class="zt-h" style="background:'+c.primaryColor+'"><div class="zt-t"><i class="fas fa-robot"></i><span>'+c.name+'</span></div><div class="zt-x"><i class="fas fa-times"></i></div></div><div class="zt-m"></div><div class="zt-i"><input type="text" placeholder="Type your message..."><button style="background:'+c.primaryColor+'"><i class="fas fa-paper-plane"></i></button></div></div>';d.body.appendChild(w);if(!d.querySelector('link[href*="font-awesome"]')){var l=d.createElement('link');l.rel='stylesheet';l.href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';d.head.appendChild(l)}var wb=w.querySelector('.zt-w'),ct=w.querySelector('.zt-c'),xb=w.querySelector('.zt-x'),inp=w.querySelector('.zt-i input'),btn=w.querySelector('.zt-i button'),msg=w.querySelector('.zt-m');var sid=localStorage.getItem('zt_session_'+c.id)||null;function gs(){return'session_'+Math.random().toString(36).substring(2,15)+Date.now().toString(36)}if(!sid)sid=gs();localStorage.setItem('zt_session_'+c.id,sid);function am(t,s){var m=d.createElement('div');m.className='zt-msg '+(s==='user'?'u':'b');var mc=d.createElement('div');mc.className='zt-msg-c';if(s==='user')mc.style.background=c.primaryColor;mc.textContent=t;m.appendChild(mc);msg.appendChild(m);msg.scrollTop=msg.scrollHeight}wb.onclick=function(){ct.style.display='block';if(msg.children.length===0)am(c.welcomeMessage,'bot')};xb.onclick=function(){ct.style.display='none'};function sm(){var m=inp.value.trim();if(!m)return;am(m,'user');inp.value='';var ti=d.createElement('div');ti.className='zt-msg b';ti.innerHTML='<div class="zt-msg-c">Typing...</div>';msg.appendChild(ti);msg.scrollTop=msg.scrollHeight;fetch(c.apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:m,chatbotId:c.id,apiKey:c.apiKey,sessionId:sid})}).then(r=>r.ok?r.json():Promise.reject()).then(d=>{ti.remove();if(d.sessionId){sid=d.sessionId;localStorage.setItem('zt_session_'+c.id,sid)}am(d.response||'Error','bot')}).catch(e=>{ti.remove();am('Error. Please try again.','bot')})}btn.onclick=sm;inp.onkeypress=function(e){if(e.key==='Enter')sm()}}();
</script>
</body>
</html>
